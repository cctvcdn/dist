(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{1596:function(e,t,s){"use strict";var a,r,n,i,o,l;a=s(117),r=s(7),s(36),s(66),n=s(1597),i=s(1616),o=s(1583),l=s(1617),t.a={name:"ProfilePage",layout:"default",middleware:"auth",mixins:[n.a],components:{UserRewards:i.default,DailyMission:o.default,ChangePasswordModal:l.default},data:function(){return{loading:!1,showChangePassword:!1,referralMissions:[],referralSummary:{},missionsLoading:!1,claimingMission:null}},computed:{user:function(){return this.$auth.user||{username:"",email:"",phone:"",role:"",name:"",avatar:"",createdAt:""}},userStats:function(){return this.$store.state.user.stats||{totalPoints:0,bananas:0}},roleClass:function(){var e;switch((null===(e=this.user.role)||void 0===e?void 0:e.toLowerCase())||""){case"admin":return"role-admin";case"ktv":return"role-ktv";case"blv":return"role-blv";case"mod":return"role-mod";case"seo":return"role-seo";case"client":return"role-client";default:return"text-white"}},referralLink:function(){if(!this.user.referralCode)return"";var e=a.env.FRONTEND_DOMAIN||window.location.origin;return"".concat(e,"/register?ref=").concat(this.user.referralCode)}},methods:{formatDate:function(e){var t=new Date(e);return new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"long",day:"numeric"}).format(t)},handleLogout:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=1,e.$auth.logout();case 1:e.$message.success("Đăng xuất thành công!"),e.$router.push("/login"),t.next=3;break;case 2:t.prev=2,t.catch(0),e.$message.error("Đăng xuất thất bại!");case 3:return t.prev=3,e.loading=!1,t.finish(3);case 4:case"end":return t.stop()}}),t,null,[[0,2,3,4]])})))()},goBack:function(){window.history.length>1?this.$router.go(-1):this.$router.push("/")},copyReferralCode:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.user.referralCode){t.next=1;break}return e.$message.error("Bạn chưa có mã giới thiệu!"),t.abrupt("return");case 1:return t.prev=1,t.next=2,navigator.clipboard.writeText(e.user.referralCode);case 2:e.$message.success("Đã copy mã giới thiệu!"),t.next=4;break;case 3:t.prev=3,t.catch(1),e.$message.error("Không thể copy mã giới thiệu!");case 4:case"end":return t.stop()}}),t,null,[[1,3]])})))()},copyReferralLink:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.referralLink){t.next=1;break}return e.$message.error("Không thể tạo link chia sẻ!"),t.abrupt("return");case 1:return t.prev=1,t.next=2,navigator.clipboard.writeText(e.referralLink);case 2:e.$message.success("Đã copy link chia sẻ!"),t.next=4;break;case 3:t.prev=3,t.catch(1),e.$message.error("Không thể copy link chia sẻ!");case 4:case"end":return t.stop()}}),t,null,[[1,3]])})))()},getTotalReferralMissions:function(){return this.referralSummary.totalMissions||0},loadReferralMissions:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.missionsLoading=!0,t.next=1,e.$axios.get("/referral-missions");case 1:(s=t.sent).data.success&&(e.referralMissions=s.data.data.missions,e.referralSummary=s.data.data.summary),t.next=3;break;case 2:t.prev=2,t.catch(0),e.$message.error("Không thể tải nhiệm vụ giới thiệu");case 3:return t.prev=3,e.missionsLoading=!1,t.finish(3);case 4:case"end":return t.stop()}}),t,null,[[0,2,3,4]])})))()},claimMission:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function s(){var a,r,n;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,t.claimingMission=e,s.next=1,t.$store.dispatch("user/claimReferralMission",e);case 1:if(!(a=s.sent).success){s.next=2;break}return t.$message.success(a.data.message),s.next=2,t.loadReferralMissions();case 2:s.next=4;break;case 3:s.prev=3,n=s.catch(0),t.$message.error((null===(r=n.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.message)||"Không thể nhận thưởng");case 4:return s.prev=4,t.claimingMission=null,s.finish(4);case 5:case"end":return s.stop()}}),s,null,[[0,3,4,5]])})))()}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(s=e.$auth)||void 0===s||!s.loggedIn){t.next=2;break}return t.next=1,e.$store.dispatch("user/fetchUserStats");case 1:return t.next=2,e.loadReferralMissions();case 2:case"end":return t.stop()}}),t)})))()}}},1665:function(e,t,s){e.exports={}},1771:function(e,t,s){"use strict";s(1665)},1861:function(e,t,s){"use strict";s.r(t),s(56);var a=s(1596).a,r=(s(1771),s(42)),n=Object(r.a)(a,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"bg-[#101820] w-full flex items-center justify-center py-4"},[t("div",{staticClass:"w-full max-w-2xl bg-[#181f2a] rounded-2xl shadow-2xl px-6 py-6 relative"},[t("button",{staticClass:"absolute top-6 left-6 text-white hover:text-green-400 transition text-2xl",on:{click:e.goBack}},[t("i",{staticClass:"fas fa-arrow-left"})]),e._v(" "),t("div",{staticClass:"flex flex-col items-center"},[t("div",{staticClass:"relative mb-4"},[t("img",{staticClass:"w-36 h-36 rounded-full object-cover border-4 border-green-400 shadow-lg transition-transform duration-300 hover:scale-105",attrs:{src:e.user.avatar,alt:"avatar"}})]),e._v(" "),t("h2",{class:["text-2xl font-bold mb-1",e.roleClass]},[e._v(e._s(e.user.name))]),e._v(" "),t("p",{staticClass:"text-green-400 text-base font-mono mb-6"},[e._v("\n        @"+e._s(e.user.username)+"\n      ")])]),e._v(" "),t("div",{staticClass:"bg-[#232b36] rounded-xl p-6 mb-8 shadow flex flex-col gap-4"},[t("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 gap-6"},[t("div",{staticClass:"flex items-center gap-3"},[t("i",{staticClass:"fas fa-envelope text-green-400 text-xl"}),e._v(" "),t("div",[t("div",{staticClass:"text-[#4ade80] text-sm font-semibold"},[e._v("Email")]),e._v(" "),t("div",{staticClass:"text-white font-medium"},[e._v(e._s(e.user.email))])])]),e._v(" "),t("div",{staticClass:"flex items-center gap-3"},[t("i",{staticClass:"fas fa-coins text-green-400 text-xl"}),e._v(" "),t("div",[t("div",{staticClass:"text-[#4ade80] text-sm font-semibold"},[e._v("\n              Số dư\n            ")]),e._v(" "),t("div",{staticClass:"text-white font-medium flex items-center gap-4"},[t("span",{staticClass:"flex items-center gap-1"},[t("i",{staticClass:"fas fa-coins text-yellow-400"}),e._v("\n                "+e._s(e.userStats.totalPoints||0)+" xu\n              ")]),e._v(" "),t("span",{staticClass:"flex items-center gap-1"},[t("i",{staticClass:"fas fa-banana text-yellow-400"}),e._v("\n                "+e._s(e.userStats.bananas||0)+" chuối\n              ")])])])]),e._v(" "),t("div",{staticClass:"flex items-center gap-3"},[t("nuxt-link",{staticClass:"flex items-center gap-3 w-full",attrs:{to:"/profile/edit"}},[t("i",{staticClass:"fas fa-edit text-green-400 text-xl"}),e._v(" "),t("div",[t("div",{staticClass:"text-[#4ade80] text-sm font-semibold"},[e._v("\n                Chỉnh sửa thông tin\n              ")]),e._v(" "),t("div",{staticClass:"text-white font-medium"},[e._v("\n                Cập nhật profile\n              ")])])])],1),e._v(" "),t("div",{staticClass:"flex items-center gap-3"},[t("button",{staticClass:"flex items-center gap-3 w-full",on:{click:function(t){e.showChangePassword=!0}}},[t("i",{staticClass:"fas fa-key text-green-400 text-xl"}),e._v(" "),e._m(0)])])])]),e._v(" "),t("div",{staticClass:"bg-[#232b36] rounded-xl p-6 mb-8 shadow"},[e._m(1),e._v(" "),t("div",{staticClass:"mb-4"},[t("div",{staticClass:"text-[#4ade80] text-sm font-semibold mb-2"},[e._v("Mã giới thiệu của bạn")]),e._v(" "),t("div",{staticClass:"flex items-center gap-2"},[t("div",{staticClass:"bg-[#101820] px-3 py-2 rounded-lg border border-green-400 flex-1"},[t("span",{staticClass:"text-green-400 font-mono text-lg"},[e._v(e._s(e.user.referralCode||"Chưa có mã"))])]),e._v(" "),t("button",{staticClass:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition",attrs:{title:"Copy mã giới thiệu"},on:{click:e.copyReferralCode}},[t("i",{staticClass:"fas fa-copy"})]),e._v(" "),t("button",{staticClass:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition",attrs:{title:"Copy link chia sẻ"},on:{click:e.copyReferralLink}},[t("i",{staticClass:"fas fa-share-alt"})])])]),e._v(" "),e.user.referredByCode?t("div",{staticClass:"mb-4"},[t("div",{staticClass:"text-[#4ade80] text-sm font-semibold mb-2"},[e._v("Được giới thiệu bởi")]),e._v(" "),t("div",{staticClass:"bg-[#101820] px-3 py-2 rounded-lg border border-green-400"},[t("span",{staticClass:"text-green-400 font-mono"},[e._v(e._s(e.user.referredByCode))])])]):e._e()]),e._v(" "),t("div",{staticClass:"bg-[#232b36] rounded-xl p-6 mb-8 shadow"},[e._m(2),e._v(" "),t("UserRewards")],1),e._v(" "),t("div",{staticClass:"flex flex-col md:flex-row gap-2 mb-8"},[t("nuxt-link",{staticClass:"flex-1 bg-[#0ea5e9] hover:bg-[#0284c7] text-white text-center py-2 rounded-md text-base shadow-lg border-2 border-[#0ea5e9] hover:border-[#0284c7] transition",attrs:{to:"/transactions"}},[t("i",{staticClass:"fas fa-receipt mr-1"}),e._v("Lịch sử giao dịch\n      ")]),e._v(" "),t("button",{staticClass:"flex-1 bg-[#ef4444] hover:bg-[#dc2626] text-white py-2 rounded-md text-base shadow-lg border-2 border-[#ef4444] transition disabled:opacity-60",attrs:{disabled:e.loading},on:{click:e.handleLogout}},[t("i",{staticClass:"fas fa-sign-out-alt mr-1"}),e._v("Đăng xuất\n      ")])],1),e._v(" "),t("ChangePasswordModal",{attrs:{visible:e.showChangePassword},on:{"update:visible":function(t){e.showChangePassword=t}}})],1)])}),[function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"text-[#4ade80] text-sm font-semibold"},[e._v("\n                Đổi mật khẩu\n              ")]),e._v(" "),t("div",{staticClass:"text-white font-medium"},[e._v("\n                Bảo mật tài khoản\n              ")])])},function(){var e=this._self._c;return e("h3",{staticClass:"text-white font-bold text-lg mb-4 flex items-center"},[e("i",{staticClass:"fas fa-share-alt text-green-400 mr-2"}),this._v("\n        Mã giới thiệu\n      ")])},function(){var e=this._self._c;return e("h3",{staticClass:"text-white font-bold text-lg mb-4 flex items-center"},[e("i",{staticClass:"fas fa-trophy text-yellow-400 mr-2"}),this._v("\n        Rewards & Achievements\n      ")])}],!1,null,"26d11b9e",null);t.default=n.exports}}]);