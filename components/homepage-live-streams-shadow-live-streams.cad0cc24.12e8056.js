(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{1734:function(e,t,a){e.exports={}},1748:function(e,t,a){"use strict";a.r(t),a(44),a(302),a(43),a(47),a(61),a(62),a(50),a(39);var i=a(28),r=(a(848),a(453)),n=(a(1527),a(1537)),s=(a(1528),a(1536)),o=(a(1529),a(1533)),l=(a(1535),a(1534)),c=(a(56),a(27),a(93),a(67),a(98),a(68),a(57),a(846),a(86)),u=a(1586),d=a(1547),m=a(1590),h=a(450);function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function f(e){for(var t=1;arguments.length>t;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}a(1525);var v={name:"ShadowLiveStreams",components:{Quality:u.default,AdSlot:d.default,LiveStreamShadowWrapper:m.default,RewardsNotification:h.default,Dropdown:l.a,Menu:o.a,Spin:s.a,Avatar:n.a,Tooltip:r.a},props:{blvID:{type:String,required:!0},blv:{type:Object,default:function(){return{}}},isHome:{type:Boolean,default:!1},streams:{type:Array,default:function(){return[]}},hostClass:{type:String,default:""}},data:function(){return{selectedQuality:"auto",isIframeLoaded:!1,iframeSrc:"",qualityRenderKey:0,isMobile:!1,showHomepageOverlay:!1,homepageOverlayTimer:null,iframeLoadTimeout:null,maxIframeLoadTime:15e3}},computed:f(f({},Object(c.d)("matches",["match"])),{},{currentBlv:function(){return this.blv||{}},defaultAvatar:function(){return"https://i.imgur.com/B9Dd3cd.gif"}}),watch:{blvID:{immediate:!0,handler:"updateStreamData"},selectedQuality:{handler:"handleQualityChange"},iframeSrc:function(e,t){e&&e!==t&&(this.isIframeLoaded=!1,this.setupIframeTimeout())}},mounted:function(){var e=this;this.checkMobile(),window.addEventListener("resize",this.checkMobile),this.setupHomepageOverlay(),this.$nextTick((function(){e.iframeSrc&&!e.isIframeLoaded&&e.setupIframeTimeout()}))},beforeDestroy:function(){this.homepageOverlayTimer&&clearTimeout(this.homepageOverlayTimer),this.iframeLoadTimeout&&clearTimeout(this.iframeLoadTimeout),window.removeEventListener("resize",this.checkMobile)},methods:f(f({},Object(c.b)("livestream",["getLiveStreamsByBlv"])),{},{checkMobile:function(){this.isMobile=768>window.innerWidth},updateStreamData:function(){this.blvID&&(this.getLiveStreamsByBlv(this.blvID),this.generateIframeSrc())},generateIframeSrc:function(){var e,t=this.$route.query.id;if(!t)return"";var a=null===(e=this.$auth)||void 0===e?void 0:e.loggedIn,i="".concat("https://live-test.chuoichien.xyz","/embed/"),r=new URLSearchParams;if(r.append("id",t),this.blvID&&r.append("blvID",this.blvID),this.currentStreamUrl&&r.append("streamUrl",this.currentStreamUrl),r.append("autoplay","1"),r.append("muted","1"),a){var n,s,o,l,c,u;r.append("isLoggedIn","true"),null!==(n=this.user)&&void 0!==n&&n.name&&r.append("nme",this.user.name),null!==(s=this.user)&&void 0!==s&&s.avatar&&r.append("pic",this.user.avatar),null!==(o=this.user)&&void 0!==o&&o.role&&r.append("role",this.user.role);var d=(null===(l=this.$store.state.user)||void 0===l||null===(l=l.stats)||void 0===l?void 0:l.currentLevel)||1;r.append("level",d);var m=null===(c=this.$auth)||void 0===c||null===(c=c.strategy)||void 0===c||null===(c=c.token)||void 0===c||null===(u=c.get)||void 0===u?void 0:u.call(c);m&&r.append("token",m.replace("Bearer ",""))}else{var h,p,f=null===(h=this.$guestToken)||void 0===h||null===(p=h.getCurrentToken)||void 0===p?void 0:p.call(h);f&&r.append("token",f)}this.isHome&&r.append("isHome",this.isHome+""),i+="?".concat(r.toString()),this.iframeSrc=i},handleIframeLoad:function(){this.isIframeLoaded=!0,this.iframeLoadTimeout&&(clearTimeout(this.iframeLoadTimeout),this.iframeLoadTimeout=null)},handleIframeError:function(){this.isIframeLoaded=!0,this.iframeLoadTimeout&&(clearTimeout(this.iframeLoadTimeout),this.iframeLoadTimeout=null)},setupIframeTimeout:function(){var e=this;this.iframeLoadTimeout&&clearTimeout(this.iframeLoadTimeout),this.iframeLoadTimeout=setTimeout((function(){e.isIframeLoaded=!0,e.iframeLoadTimeout=null}),this.maxIframeLoadTime)},handleIframeInteraction:function(){},handleQualityChange:function(e){this.selectedQuality=e,this.qualityRenderKey++,this.generateIframeSrc()},handleChangeBranch:function(e){this.$emit("change-branch",e)},goToLivePage:function(){this.isHome&&this.$router.push("/live/".concat(this.blvID))},setupHomepageOverlay:function(){var e=this;this.isHome&&(this.homepageOverlayTimer=setTimeout((function(){e.showHomepageOverlay=!0}),5e3))}})},y=(a(1849),a(42)),g=Object(y.a)(v,(function(){var e,t=this,a=t._self._c;return a("LiveStreamShadowWrapper",{attrs:{"is-home":t.isHome,"is-mobile":t.isMobile,"host-class":t.hostClass}},[a("RewardsNotification"),t._v(" "),a("div",{staticClass:"transition-all duration-300 ease-in-out w-full",class:{"sticky top-0 z-[1002]":t.isMobile&&!t.isHome}},[t.isHome?a("div",{staticClass:"player-container relative w-full aspect-[16/9]"},[t.isHome?a("div",{staticClass:"homepage-overlay",on:{click:function(e){return e.stopPropagation(),t.goToLivePage.apply(null,arguments)}}},[a("div",{staticClass:"overlay-content"},[a("div",{staticClass:"play-button"},[a("i",{staticClass:"play-icon fas fa-play"}),t._v(" "),a("span",{staticClass:"play-text"},[t._v("Vào phòng live")])])])]):t._e(),t._v(" "),t.iframeSrc?a("iframe",{staticClass:"live-streams absolute inset-0 w-full h-full",attrs:{src:t.iframeSrc,width:"100%",height:"100%",allowtransparency:"yes",allow:"autoplay; fullscreen; encrypted-media; picture-in-picture",frameborder:"0",marginheight:"0",marginwidth:"0",scrolling:"auto",playsinline:"","webkit-playsinline":"",loading:"eager",fetchpriority:"high"},on:{load:t.handleIframeLoad,error:t.handleIframeError,mouseenter:t.handleIframeInteraction,click:t.handleIframeInteraction}}):t._e()]):a("div",{staticClass:"bg-black z-50"},[a("div",{staticClass:"player-container relative w-full aspect-[16/9]"},[t.isHome?a("div",{staticClass:"homepage-overlay",on:{click:function(e){return e.stopPropagation(),t.goToLivePage.apply(null,arguments)}}},[a("div",{staticClass:"overlay-content"},[a("div",{staticClass:"play-button"},[a("i",{staticClass:"play-icon fas fa-play"}),t._v(" "),a("span",{staticClass:"play-text"},[t._v("Vào phòng live")])])])]):t._e(),t._v(" "),t.iframeSrc?a("iframe",{staticClass:"live-streams absolute inset-0 w-full h-full",attrs:{src:t.iframeSrc,width:"100%",height:"100%",allowtransparency:"yes",allow:"autoplay; fullscreen; encrypted-media; picture-in-picture",frameborder:"0",marginheight:"0",marginwidth:"0",scrolling:"auto",playsinline:"","webkit-playsinline":"",loading:"eager",fetchpriority:"high"},on:{load:t.handleIframeLoad,error:t.handleIframeError,mouseenter:t.handleIframeInteraction,click:t.handleIframeInteraction}}):t._e(),t._v(" "),t.isIframeLoaded?t._e():a("div",{staticClass:"loading-overlay"},[a("div",{staticClass:"loading-content"},[a("div",{staticClass:"loading-spinner"},[a("div",{staticClass:"spinner-outer"}),t._v(" "),a("div",{staticClass:"spinner-inner"})]),t._v(" "),a("span",{staticClass:"text-white/90 text-sm font-medium"},[t._v("Đang tải player...")])])])]),t._v(" "),t.isHome?t._e():a("div",{staticClass:"bg-black border-t border-white/10 sticky top-0 z-50"},[a("div",{staticClass:"px-0 py-0"},[a("Quality",{attrs:{selectedBlv:{streams:(null===(e=t.currentBlv)||void 0===e?void 0:e.streams)||[]},qualityRenderKey:t.qualityRenderKey,match:t.match,blvID:t.blvID,defaultAvatar:t.defaultAvatar},on:{change:t.handleQualityChange,"change-branch":t.handleChangeBranch},model:{value:t.selectedQuality,callback:function(e){t.selectedQuality=e},expression:"selectedQuality"}})],1)])])])],1)}),[],!1,null,"700952fb",null);t.default=g.exports,installComponents(g,{LiveStreamShadowWrapper:a(1590).default})},1849:function(e,t,a){"use strict";a(1734)}}]);